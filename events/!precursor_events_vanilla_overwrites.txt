########################
#
# Precursor Events
#
# Written by Henrik Thyrwall
#
########################

namespace = precursor

### The Vultaum Star Assembly

# Vultaum Introduction
ship_event = {
	id = precursor.1
	title = "precursor.1.name"
	desc = "precursor.1.desc"
	picture = GFX_evt_archaeological_dig

	is_triggered_only = yes

	trigger = {
#		owner = { is_ai = no }
		solar_system = { has_star_flag = precursor_1 }
		solar_system = { NOT = { is_same_empire = root.owner.capital_scope.solar_system } }
		FROM = {
			has_anomaly = no
			is_star = no
		}
		owner = {
			NOT = {
				has_country_flag = vultaum_intro
#				has_country_flag = yuht_intro
#				has_country_flag = first_league_intro
#				has_country_flag = irassian_intro
#				has_country_flag = cybrex_intro
#				has_country_flag = zroni_intro
#				has_country_flag = baol_intro
			}
		}
	}

	immediate = {
		owner = { set_country_flag = vultaum_intro }
	}

	option = {
		name = INTERESTING
		hidden_effect = { owner = { country_event = { id = story.5 days = 30 } } }
		owner = {
			begin_event_chain = {
				event_chain = "vultaum_chain"
				target = THIS
			}
			if = {
				limit = { has_ancrel = yes }
				small_artifact_reward = yes
			}
		}
	}
}

# Vultaum Homeworld
ship_event = {
	id = precursor.101
	title = "precursor.101.name"
	desc = "precursor.101.desc"
	picture = GFX_evt_archaeological_dig
	location = from

	is_triggered_only = yes

	trigger = {
		fromfrom = { has_planet_flag = vultaum_homeworld }
		owner = {
#			is_ai = no
			has_country_flag = vultaum_system
		}
	}

	immediate = {
		owner = {
			set_country_flag = vultaum_world_found
			set_global_flag = vultaum_homeworld_found
			if = {
				limit = { has_event_chain = vultaum_chain }
				end_event_chain = "vultaum_chain"
			}
			if = {
				limit = { has_event_chain = "vultaum_homeworld_chain" }
				end_event_chain = "vultaum_homeworld_chain"
			}
		}
	}

	option = {
		name = "FASCINATING"
		owner = {
			if = {
				limit = { has_ancrel = yes }
				add_relic = r_reality_perforator
				large_artifact_reward = yes
			}
			add_monthly_resource_mult = {
				resource = unity
				value = 120
				min = 240
				max = 9999
			}
			add_monthly_resource_mult = {
				resource = physics_research
				value = @tier3researchreward
				min = @tier3researchmin
				max = @tier3researchmax
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier3researchreward
				min = @tier3researchmin
				max = @tier3researchmax
			}
			add_monthly_resource_mult = {
				resource = engineering_research
				value = @tier3researchreward
				min = @tier3researchmin
				max = @tier3researchmax
			}
			if = {
				limit = { has_ancrel = yes }
				custom_tooltip = vultaum_artifact_research_unlocked
			}
		}
	}
}

### The Yuht Empire

# Yuht Intro
ship_event = {
	id = precursor.500
	title = "precursor.500.name"
	desc = "precursor.500.desc"
	picture = GFX_evt_archaeological_dig
	location = from

	is_triggered_only = yes

	trigger = {
		solar_system = { has_star_flag = precursor_2 }
		solar_system = { NOT = { is_same_empire = root.owner.capital_scope.solar_system } }
#		owner = { is_ai = no }
		FROM = {
			has_anomaly = no
			is_star = no
		}
		owner = {
			NOT = {
#				has_country_flag = vultaum_intro
				has_country_flag = yuht_intro
#				has_country_flag = first_league_intro
#				has_country_flag = irassian_intro
#				has_country_flag = cybrex_intro
#				has_country_flag = zroni_intro
#				has_country_flag = baol_intro
			}
		}
	}

	immediate = {
		owner = { set_country_flag = yuht_intro }
	}

	option = {
		name = INTERESTING
		hidden_effect = { owner = { country_event = { id = story.5 days = 30 } } }
		owner = {
			begin_event_chain = {
				event_chain = "yuht_chain"
				target = THIS
			}
			if = {
				limit = { has_ancrel = yes }
				small_artifact_reward = yes
			}
		}
	}
}

# Yuht Homeworld
ship_event = {
	id = precursor.601
	title = "precursor.601.name"
	desc = "precursor.601.desc"
	picture = GFX_evt_archaeological_dig
	location = from

	is_triggered_only = yes

	trigger = {
		fromfrom = { has_planet_flag = yuht_homeworld }
		owner = {
#			is_ai = no
			has_country_flag = yuht_system
		}
	}

	immediate = {
		set_global_flag = yuht_homeworld_found
		owner = {
			set_country_flag = yuht_world_found
			end_event_chain = "yuht_homeworld_chain"
		}
	}

	option = {
		name = "FASCINATING"
		owner = {
			if = {
				limit = { has_ancrel = yes }
				add_relic = r_cryo_core
				large_artifact_reward = yes
			}
			add_monthly_resource_mult = {
				resource = unity
				value = 120
				min = 240
				max = 9999
			}
			add_monthly_resource_mult = {
				resource = energy
				value = @tier4materialreward
				min = @tier4materialmin
				max = @tier4materialmax
			}
			add_monthly_resource_mult = {
				resource = minerals
				value = @tier4materialreward
				min = @tier4materialmin
				max = @tier4materialmax
			}

			if = {
				limit = { has_ancrel = yes }
				custom_tooltip = yuht_artifact_research_unlocked
			}
		}
	}
}

### The First League

# First League Notification Event
ship_event = {
	id = precursor.1000
	title = "precursor.1000.name"
	desc = "precursor.1000.desc"
	picture = GFX_evt_archaeological_dig

	is_triggered_only = yes

	trigger = {
		solar_system = { has_star_flag = precursor_3 }
		solar_system = { NOT = { is_same_empire = root.owner.capital_scope.solar_system } }
#		owner = { is_ai = no }
		FROM = {
			has_anomaly = no
			is_star = no
		}
		owner = {
			NOT = {
#				has_country_flag = vultaum_intro
#				has_country_flag = yuht_intro
				has_country_flag = first_league_intro
#				has_country_flag = irassian_intro
#				has_country_flag = cybrex_intro
#				has_country_flag = zroni_intro
#				has_country_flag = baol_intro
			}
		}
	}

	immediate = {
		owner = { set_country_flag = first_league_intro }
	}

	option = {
		name = INTERESTING
		hidden_effect = { owner = { country_event = { id = story.5 days = 30 } } }
		owner = {
			begin_event_chain = {
				event_chain = "first_league_chain"
				target = THIS
			}
			if = {
				limit = { has_ancrel = yes }
				small_artifact_reward = yes
			}
		}
	}
}

# First League Homeworld
ship_event = {
	id = precursor.1101
	title = "precursor.1101.name"
	desc = "precursor.1101.desc"
	picture = GFX_evt_dead_city
	location = from

	is_triggered_only = yes

	trigger = {
		fromfrom = { has_planet_flag = first_league_homeworld }
		owner = {
#			is_ai = no
			has_country_flag = first_league_system
		}
	}

	immediate = {
		owner = {
			set_country_flag = league_world_found
			set_global_flag = first_league_homeworld_found
		}
	}

	after = {
		owner = {
			add_monthly_resource_mult = {
				resource = unity
				value = 120
				min = 240
				max = 9999
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier4researchreward
				min = @tier4researchmin
				max = @tier4researchmax
			}
			add_monthly_resource_mult = {
				resource = influence
				value = @tier4influencereward
				min = @tier4influencemin
				max = @tier4influencemax
			}

			if = {
				limit = { has_ancrel = yes }
				custom_tooltip = league_artifact_research_unlocked
			}
		}
	}

	option = {
		name = "FASCINATING"
		trigger = {
			owner = {
				has_event_chain = "first_league_homeworld_chain"
			}
		}
		owner = {
			end_event_chain = "first_league_homeworld_chain"
		}
	}

	option = {
		name = "FASCINATING"
		trigger = {
			owner = {
				NOT = {
					has_event_chain = "first_league_homeworld_chain"
				}
			}
		}
	}
}

### The Irassian Concordat

# Irassian Notification Event
ship_event = {
	id = precursor.1500
	title = "precursor.1500.name"
	desc = "precursor.1500.desc"
	picture = GFX_evt_archaeological_dig

	is_triggered_only = yes

	trigger = {
		solar_system = { has_star_flag = precursor_4 }
		solar_system = { NOT = { is_same_empire = root.owner.capital_scope.solar_system } }
#		owner = { is_ai = no }
		FROM = {
			has_anomaly = no
			is_star = no
		}
		owner = {
			NOT = {
#				has_country_flag = vultaum_intro
#				has_country_flag = yuht_intro
#				has_country_flag = first_league_intro
				has_country_flag = irassian_intro
#				has_country_flag = cybrex_intro
#				has_country_flag = zroni_intro
#				has_country_flag = baol_intro
			}
		}
	}

	immediate = {
		owner = { set_country_flag = irassian_intro }
	}

	option = {
		name = INTERESTING
		hidden_effect = { owner = { country_event = { id = story.5 days = 30 } } }
		owner = {
			begin_event_chain = {
				event_chain = "irassian_chain"
				target = ROOT
			}
			if = {
				limit = { has_ancrel = yes }
				small_artifact_reward = yes
			}
		}
	}
}

# Irassian Homeworld
ship_event = {
	id = precursor.1601
	title = "precursor.1601.name"
	desc = "precursor.1601.desc"
	picture = GFX_evt_dead_city
	location = from

	is_triggered_only = yes

	trigger = {
		fromfrom = { has_planet_flag = irassian_homeworld }
		owner = {
#			is_ai = no
			has_country_flag = irassian_system
		}
	}

	immediate = {
		owner = {
			set_country_flag = irassian_world_found
			set_global_flag = irassian_homeworld_found
			if = {
				limit = { has_event_chain = irassian_chain }
				end_event_chain = "irassian_chain"
			}
			if = {
				limit = { has_event_chain = irassian_homeworld_chain }
				end_event_chain = irassian_homeworld_chain
			}
		}
	}

	option = {
		name = "FASCINATING"
		owner = {
			if = {
				limit = { has_ancrel = yes }
				add_relic = r_pox_sample
				large_artifact_reward = yes
			}
			add_monthly_resource_mult = {
				resource = unity
				value = 120
				min = 240
				max = 9999
			}
			add_monthly_resource_mult = {
				resource = physics_research
				value = @tier4researchreward
				min = @tier4researchmin
				max = @tier4researchmax
			}
			add_monthly_resource_mult = {
				resource = minerals
				value = @tier4materialreward
				min = @tier4materialmin
				max = @tier4materialmax
			}

			if = {
				limit = { has_ancrel = yes }
				custom_tooltip = irassian_artifact_research_unlocked
			}
		}
	}
}

### The Cybrex

# Cybrex Notification Event
ship_event = {
	id = precursor.2000
	title = "precursor.2000.name"
	desc = "precursor.2000.desc"
	picture = GFX_evt_archaeological_dig

	is_triggered_only = yes

	trigger = {
		solar_system = { has_star_flag = precursor_5 }
		solar_system = { NOT = { is_same_empire = root.owner.capital_scope.solar_system } }
#		owner = { is_ai = no }
		FROM = {
			has_anomaly = no
			is_star = no
		}
		owner = {
			NOT = {
#				has_country_flag = vultaum_intro
#				has_country_flag = yuht_intro
#				has_country_flag = first_league_intro
#				has_country_flag = irassian_intro
				has_country_flag = cybrex_intro
#				has_country_flag = zroni_intro
#				has_country_flag = baol_intro
			}
		}
	}

	immediate = {
		owner = { set_country_flag = cybrex_intro }
	}

	option = {
		name = INTERESTING
		hidden_effect = { owner = { country_event = { id = story.5 days = 30 } } }
		owner = {
			begin_event_chain = {
				event_chain = "cybrex_chain"
				target = ROOT
			}
			if = {
				limit = { has_ancrel = yes }
				small_artifact_reward = yes
			}
		}
	}
}

# New Precursor Anomaly Found
country_event = {
	id = precursor.301
	title = "precursor.301.name"
	desc = {
		trigger = {
			NOR = {
				has_authority = auth_machine_intelligence
				has_authority = auth_hive_mind
			}
		}
		text = precursor.301.a.desc
	}
	desc = {
		trigger = {
			NOR = {
				has_authority = auth_machine_intelligence
				has_authority = auth_hive_mind
			}
		}
		text = precursor.301.b.desc
	}
	desc = {
		trigger = {
			NOR = {
				has_authority = auth_machine_intelligence
				has_authority = auth_hive_mind
			}
		}
		text = precursor.301.c.desc
	}
	desc = {
		trigger = {
			NOR = {
				has_authority = auth_machine_intelligence
				has_authority = auth_hive_mind
			}
		}
		text = precursor.301.d.desc
	}
	desc = {
		trigger = {
			has_authority = auth_machine_intelligence
		}
		text = precursor.301.e.desc
	}
	desc = {
		trigger = {
			has_authority = auth_hive_mind
		}
		text = precursor.301.f.desc
	}
	picture = GFX_evt_archaeological_dig
	location = event_target:precursor_planet
	trackable = yes

	trigger = {
#		is_ai = no
		years_passed > 50
		NOR = {
			has_country_flag = new_precursor
			has_country_flag = ongoing_precursor_artifact
		}
		OR = {
			AND = {
				has_event_chain = "vultaum_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = vultaum_chain
						counter = vultaum_artifacts
					}
				}
				any_system_within_border = {
					has_star_flag = precursor_1
					any_system_planet = {
						NOT = { has_planet_flag = precursor_world }
						uninhabitable_regular_planet = yes
						has_owner = no
						has_anomaly = no
						is_surveyed = {
							who = ROOT
							status = yes
						}
					}
				}
			}
			AND = {
				has_event_chain = "yuht_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = yuht_chain
						counter = yuht_artifacts
					}
				}
				any_system_within_border = {
					has_star_flag = precursor_2
					any_system_planet = {
						uninhabitable_regular_planet = yes
						NOT = { has_planet_flag = precursor_world }
						has_owner = no
						has_anomaly = no
						is_surveyed = {
							who = ROOT
							status = yes
						}
					}
				}
			}
			AND = {
				has_event_chain = "first_league_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = first_league_chain
						counter = first_league_artifacts
					}
				}
				any_system_within_border = {
					has_star_flag = precursor_3
					any_system_planet = {
						uninhabitable_regular_planet = yes
						NOT = { has_planet_flag = precursor_world }
						has_owner = no
						has_anomaly = no
						is_surveyed = {
							who = ROOT
							status = yes
						}
					}
				}
			}
			AND = {
				has_event_chain = "irassian_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = irassian_chain
						counter = irassian_artifacts
					}
				}
				any_system_within_border = {
					has_star_flag = precursor_4
					any_system_planet = {
						uninhabitable_regular_planet = yes
						NOT = { has_planet_flag = precursor_world }
						has_owner = no
						has_anomaly = no
						is_surveyed = {
							who = ROOT
							status = yes
						}
					}
				}
			}
			AND = {
				has_event_chain = "cybrex_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = cybrex_chain
						counter = cybrex_artifacts
					}
				}
				any_system_within_border = {
					has_star_flag = precursor_5
					any_system_planet = {
						uninhabitable_regular_planet = yes
						NOT = { has_planet_flag = precursor_world }
						has_owner = no
						has_anomaly = no
						is_surveyed = {
							who = ROOT
							status = yes
						}
					}
				}
			}
		}
	}

	mean_time_to_happen = {
		months = 240
		modifier = {
			factor = 0.66
			has_ethic = ethic_gestalt_consciousness # Won't get the other events
		}
		modifier = {
			factor = 0.75
			years_passed > 100
		}
	}

	immediate = {
		set_timed_country_flag = { flag = new_precursor days = 1200 }
		if = {
			limit = {
				has_event_chain = "vultaum_chain"
				any_system_within_border = {
					has_star_flag = precursor_1
				}
			}
			spawn_vultaum_anomaly = yes
			break = yes
		}
		if = {
			limit = {
				has_event_chain = "yuht_chain"
				any_system_within_border = {
					has_star_flag = precursor_2
				}
			}
			spawn_yuht_anomaly = yes
			break = yes
		}
		if = {
			limit = {
				has_event_chain = "first_league_chain"
				any_system_within_border = {
					has_star_flag = precursor_3
				}
			}
			spawn_league_anomaly = yes
			break = yes
		}
		if = {
			limit = {
				has_event_chain = "irassian_chain"
				any_system_within_border = {
					has_star_flag = precursor_4
				}
			}
			spawn_irassian_anomaly = yes
			break = yes
		}
		if = {
			limit = {
				has_event_chain = "cybrex_chain"
				any_system_within_border = {
					has_star_flag = precursor_5
				}
			}
			spawn_cybrex_anomaly = yes
			break = yes
		}
	}

	option = {
		name = precursor.301.a
		custom_tooltip = new_precursor_project
	}
}

# Private Collector has Artifact
country_event = {
	id = precursor.310
	title = "precursor.310.name"
	desc = "precursor.310.desc"
	picture = GFX_evt_archaeological_dig
	location = event_target:collector_home

	trigger = {
#		is_ai = no
		years_passed > 50
		NOR = {
			has_country_flag = new_precursor
			has_country_flag = ongoing_precursor_artifact
			has_country_flag = precursor_collector_fired
			has_ethic = ethic_gestalt_consciousness
		}
		OR = {
			AND = {
				has_event_chain = "vultaum_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = vultaum_chain
						counter = vultaum_artifacts
					}
				}
			}
			AND = {
				has_event_chain = "yuht_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = yuht_chain
						counter = yuht_artifacts
					}
				}
			}
			AND = {
				has_event_chain = "first_league_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = first_league_chain
						counter = first_league_artifacts
					}
				}
			}
			AND = {
				has_event_chain = "irassian_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = irassian_chain
						counter = irassian_artifacts
					}
				}
			}
			AND = {
				has_event_chain = "cybrex_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = cybrex_chain
						counter = cybrex_artifacts
					}
				}
			}
		}
	}

	mean_time_to_happen = {
		months = 240
		modifier = {
			factor = 0.75
			years_passed > 100
		}
	}

	immediate = {
		set_timed_country_flag = { flag = new_precursor days = 1200 }
		set_country_flag = precursor_collector_fired
		random_owned_planet = { save_event_target_as = collector_home }
		if = {
			limit = { has_event_chain = "vultaum_chain" }
			set_country_flag = vultaum_artifact_recoverer
			break = yes
		}
		if = {
			limit = { has_event_chain = "yuht_chain" }
			set_country_flag = yuht_artifact_recoverer
			break = yes
		}
		if = {
			limit = { has_event_chain = "first_league_chain" }
			set_country_flag = first_league_artifact_recoverer
			break = yes
		}
		if = {
			limit = { has_event_chain = "irassian_chain" }
			set_country_flag = irassian_artifact_recoverer
			break = yes
		}
		if = {
			limit = { has_event_chain = "cybrex_chain" }
			set_country_flag = cybrex_artifact_recoverer
			break = yes
		}
	}

	after = {
		hidden_effect = {
			remove_country_flag = vultaum_artifact_recoverer
			remove_country_flag = yuht_artifact_recoverer
			remove_country_flag = first_league_artifact_recoverer
			remove_country_flag = irassian_artifact_recoverer
			remove_country_flag = cybrex_artifact_recoverer
		}
	}

	option = {
		name = precursor.310.a
		allow = { resource_stockpile_compare = { resource = energy value >= 500 } }
		custom_tooltip = buy_precursor_artifact
		add_resource = { energy = -500 }
		collector_surrenders_artifact = yes
	}
	option = {
		name = precursor.310.b
		allow = { resource_stockpile_compare = { resource = influence value >= 100 } }
		custom_tooltip = seize_precursor_artifact
		add_resource = { influence = -100 }
		collector_surrenders_artifact = yes
	}
	option = {
		name = precursor.310.c
		custom_tooltip = leave_precursor_artifact
	}
}

# Neighbor Offers to Sell Artifact
country_event = {
	id = precursor.311
	title = TRANSMISSION
	desc = "precursor.311.desc"

	diplomatic = yes

	picture_event_data = {
		portrait = event_target:artifact_seller
		room = event_target:artifact_seller.ruler
	}

	trigger = {
#		is_ai = no
		years_passed > 50
		NOR = {
			has_country_flag = new_precursor
			has_country_flag = ongoing_precursor_artifact
			has_country_flag = precursor_seller_fired
			has_ethic = ethic_gestalt_consciousness
			AND = {
				exists = event_target:artifact_seller
				has_relation_flag = {
					who = event_target:artifact_seller
					flag = precursor_artifact_deal
				}
			}
		}
		OR = {
			AND = {
				has_event_chain = "vultaum_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = vultaum_chain
						counter = vultaum_artifacts
					}
				}
				any_neighbor_country = {
					has_communications = root
					is_country_type = default
					is_subject = no
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
						is_hostile_to = root
						is_domineering_to = root
						is_unfriendly_to = root
					}
					any_system_within_border = { has_star_flag = precursor_1 }
				}
			}
			AND = {
				has_event_chain = "yuht_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = yuht_chain
						counter = yuht_artifacts
					}
				}
				any_neighbor_country = {
					has_communications = root
					is_country_type = default
					is_subject = no
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
						is_hostile_to = root
						is_domineering_to = root
						is_unfriendly_to = root
					}
					any_system_within_border = { has_star_flag = precursor_2 }
				}
			}
			AND = {
				has_event_chain = "first_league_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = first_league_chain
						counter = first_league_artifacts
					}
				}
				any_neighbor_country = {
					has_communications = root
					is_country_type = default
					is_subject = no
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
						is_hostile_to = root
						is_domineering_to = root
						is_unfriendly_to = root
					}
					any_system_within_border = { has_star_flag = precursor_3 }
				}
			}
			AND = {
				has_event_chain = "irassian_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = irassian_chain
						counter = irassian_artifacts
					}
				}
				any_neighbor_country = {
					has_communications = root
					is_country_type = default
					is_subject = no
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
						is_hostile_to = root
						is_domineering_to = root
						is_unfriendly_to = root
					}
					any_system_within_border = { has_star_flag = precursor_4 }
				}
			}
			AND = {
				has_event_chain = "cybrex_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = cybrex_chain
						counter = cybrex_artifacts
					}
				}
				any_neighbor_country = {
					has_communications = root
					is_country_type = default
					is_subject = no
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
						is_hostile_to = root
						is_domineering_to = root
						is_unfriendly_to = root
					}
					any_system_within_border = { has_star_flag = precursor_5 }
				}
			}
		}
	}

	mean_time_to_happen = {
		months = 240
		modifier = {
			factor = 0.75
			years_passed > 100
		}
	}

	immediate = {
		set_country_flag = precursor_seller_fired
		set_timed_country_flag = { flag = new_precursor days = 1200 }
		if = {
			limit = { has_event_chain = "vultaum_chain" }
			set_country_flag = vultaum_artifact_recoverer
			random_neighbor_country = {
				limit = {
					has_communications = root
					is_country_type = default
					is_subject = no
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
						is_hostile_to = root
						is_domineering_to = root
						is_unfriendly_to = root
					}
					any_system_within_border = { has_star_flag = precursor_1 }
				}
				save_event_target_as = artifact_seller
			}
			break = yes
		}
		if = {
			limit = { has_event_chain = "yuht_chain" }
			set_country_flag = yuht_artifact_recoverer
			random_neighbor_country = {
				limit = {
					has_communications = root
					is_country_type = default
					is_subject = no
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
						is_hostile_to = root
						is_domineering_to = root
						is_unfriendly_to = root
					}
					any_system_within_border = { has_star_flag = precursor_2 }
				}
				save_event_target_as = artifact_seller
			}
			break = yes
		}
		if = {
			limit = { has_event_chain = "first_league_chain" }
			set_country_flag = first_league_artifact_recoverer
			random_neighbor_country = {
				limit = {
					has_communications = root
					is_country_type = default
					is_subject = no
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
						is_hostile_to = root
						is_domineering_to = root
						is_unfriendly_to = root
					}
					any_system_within_border = { has_star_flag = precursor_3 }
				}
				save_event_target_as = artifact_seller
			}
			break = yes
		}
		if = {
			limit = { has_event_chain = "irassian_chain" }
			set_country_flag = irassian_artifact_recoverer
			random_neighbor_country = {
				limit = {
					has_communications = root
					is_country_type = default
					is_subject = no
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
						is_hostile_to = root
						is_domineering_to = root
						is_unfriendly_to = root
					}
					any_system_within_border = { has_star_flag = precursor_4 }
				}
				save_event_target_as = artifact_seller
			}
			break = yes
		}
		if = {
			limit = { has_event_chain = "cybrex_chain" }
			set_country_flag = cybrex_artifact_recoverer
			random_neighbor_country = {
				limit = {
					has_communications = root
					is_country_type = default
					is_subject = no
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
						is_hostile_to = root
						is_domineering_to = root
						is_unfriendly_to = root
					}
					any_system_within_border = { has_star_flag = precursor_5 }
				}
				save_event_target_as = artifact_seller
			}
			break = yes
		}
		set_relation_flag = {
			who = event_target:artifact_seller
			flag = precursor_artifact_deal
		}
	}

	after = {
		hidden_effect = {
			remove_country_flag = vultaum_artifact_recoverer
			remove_country_flag = yuht_artifact_recoverer
			remove_country_flag = first_league_artifact_recoverer
			remove_country_flag = irassian_artifact_recoverer
			remove_country_flag = cybrex_artifact_recoverer
		}
	}

	option = {
		name = "precursor.311.a"
		response_text = precursor.311.a.reply
		allow = { resource_stockpile_compare = { resource = energy value >= 1000 } }
		custom_tooltip = purchase_artifact
		add_resource = { energy = -1000 }
		hidden_effect = {
			event_target:artifact_seller = { add_resource = { energy = 1000 } }
		}
		collector_surrenders_artifact = yes
	}
	option = {
		name = "precursor.311.b"
		response_text = precursor.311.b.reply
		allow = { resource_stockpile_compare = { resource = energy value >= 500 } }
		trigger = { has_valid_civic = civic_corporate_dominion }
		custom_tooltip = purchase_artifact
		add_resource = { energy = -500 }
		hidden_effect = {
			event_target:artifact_seller = { add_resource = { energy = 500 } }
		}
		collector_surrenders_artifact = yes
	}
	option = {
		name = "precursor.311.c"
		trigger = { has_valid_civic = civic_warrior_culture }
		hidden_effect = {
			random_list = {
				10 = { # Refuses
					modifier = {
						factor = 50
						relative_power = {
							who = event_target:artifact_seller
							category = fleet
							value = inferior
						}
					}
					modifier = {
						factor = 50
						relative_power = {
							who = event_target:artifact_seller
							category = fleet
							value = pathetic
						}
					}
					modifier = {
						factor = 50
						event_target:artifact_seller = { has_valid_civic = civic_warrior_culture }
					}
					country_event = { id = precursor.312 }
				}
				10 = { # Folds
					modifier = {
						factor = 50
						relative_power = {
							who = event_target:artifact_seller
							category = fleet
							value = superior
						}
					}
					modifier = {
						factor = 50
						relative_power = {
							who = event_target:artifact_seller
							category = fleet
							value = overwhelming
						}
					}
					country_event = { id = precursor.313 }
				}
			}
		}
		custom_tooltip = coerce_artifact
	}
	option = {
		name = "precursor.311.d"
	}
}

# Neighbor Gifts Artifact
country_event = {
	id = precursor.314
	title = TRANSMISSION
	desc = "precursor.314.desc"

	diplomatic = yes

	picture_event_data = {
		portrait = event_target:artifact_giver
		room = event_target:artifact_giver.ruler
	}

	trigger = {
#		is_ai = no
		years_passed > 50
		NOR = {
			has_country_flag = new_precursor
			has_country_flag = ongoing_precursor_artifact
			has_country_flag = precursor_giver_fired
			has_ethic = ethic_gestalt_consciousness
			AND = {
				exists = event_target:artifact_giver
				has_relation_flag = {
					who = event_target:artifact_giver
					flag = precursor_artifact_deal
				}
			}
		}
		OR = {
			AND = {
				has_event_chain = "vultaum_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = vultaum_chain
						counter = vultaum_artifacts
					}
				}
				any_neighbor_country = {
					has_communications = root
					is_country_type = default
					is_subject = no
					OR = {
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
					}
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
					}
					any_system_within_border = { has_star_flag = precursor_1 }
				}
			}
			AND = {
				has_event_chain = "yuht_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = yuht_chain
						counter = yuht_artifacts
					}
				}
				any_neighbor_country = {
					has_communications = root
					is_country_type = default
					is_subject = no
					OR = {
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
					}
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
					}
					any_system_within_border = { has_star_flag = precursor_2 }
				}
			}
			AND = {
				has_event_chain = "first_league_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = first_league_chain
						counter = first_league_artifacts
					}
				}
				any_neighbor_country = {
					has_communications = root
					is_country_type = default
					is_subject = no
					OR = {
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
					}
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
					}
					any_system_within_border = { has_star_flag = precursor_3 }
				}
			}
			AND = {
				has_event_chain = "irassian_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = irassian_chain
						counter = irassian_artifacts
					}
				}
				any_neighbor_country = {
					has_communications = root
					is_country_type = default
					is_subject = no
					OR = {
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
					}
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
					}
					any_system_within_border = { has_star_flag = precursor_4 }
				}
			}
			AND = {
				has_event_chain = "cybrex_chain"
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = cybrex_chain
						counter = cybrex_artifacts
					}
				}
				any_neighbor_country = {
					has_communications = root
					is_country_type = default
					is_subject = no
					OR = {
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
					}
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
					}
					any_system_within_border = { has_star_flag = precursor_5 }
				}
			}
		}
	}

	mean_time_to_happen = {
		months = 240
		modifier = {
			factor = 0.75
			years_passed > 100
		}
	}

	immediate = {
		set_country_flag = precursor_giver_fired
		set_timed_country_flag = { flag = new_precursor days = 1200 }
		if = {
			limit = { has_event_chain = "vultaum_chain" }
			set_country_flag = vultaum_artifact_recoverer
			random_neighbor_country = {
				limit = {
					has_communications = root
					is_country_type = default
					is_subject = no
					OR = {
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
					}
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
					}
					any_system_within_border = { has_star_flag = precursor_1 }
				}
				save_event_target_as = artifact_giver
			}
			break = yes
		}
		if = {
			limit = { has_event_chain = "yuht_chain" }
			set_country_flag = yuht_artifact_recoverer
			random_neighbor_country = {
				limit = {
					has_communications = root
					is_country_type = default
					is_subject = no
					OR = {
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
					}
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
					}
					any_system_within_border = { has_star_flag = precursor_2 }
				}
				save_event_target_as = artifact_giver
			}
			break = yes
		}
		if = {
			limit = { has_event_chain = "first_league_chain" }
			set_country_flag = first_league_artifact_recoverer
			random_neighbor_country = {
				limit = {
					has_communications = root
					is_country_type = default
					is_subject = no
					OR = {
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
					}
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
					}
					any_system_within_border = { has_star_flag = precursor_3 }
				}
				save_event_target_as = artifact_giver
			}
			break = yes
		}
		if = {
			limit = { has_event_chain = "irassian_chain" }
			set_country_flag = irassian_artifact_recoverer
			random_neighbor_country = {
				limit = {
					has_communications = root
					is_country_type = default
					is_subject = no
					OR = {
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
					}
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
					}
					any_system_within_border = { has_star_flag = precursor_4 }
				}
				save_event_target_as = artifact_giver
			}
			break = yes
		}
		if = {
			limit = { has_event_chain = "cybrex_chain" }
			set_country_flag = cybrex_artifact_recoverer
			random_neighbor_country = {
				limit = {
					has_communications = root
					is_country_type = default
					is_subject = no
					OR = {
						is_protective_to = root
						is_friendly_to = root
						is_loyal_to = root
					}
					NOR = {
						has_ethic = ethic_gestalt_consciousness
						is_at_war_with = root
						is_same_value = root
					}
					any_system_within_border = { has_star_flag = precursor_5 }
				}
				save_event_target_as = artifact_giver
			}
			break = yes
		}
		set_relation_flag = {
			who = event_target:artifact_giver
			flag = precursor_artifact_deal
		}
	}

	after = {
		hidden_effect = {
			remove_country_flag = vultaum_artifact_recoverer
			remove_country_flag = yuht_artifact_recoverer
			remove_country_flag = first_league_artifact_recoverer
			remove_country_flag = irassian_artifact_recoverer
			remove_country_flag = cybrex_artifact_recoverer
		}
	}

	option = {
		name = "precursor.314.a"
		collector_surrenders_artifact = yes
	}
}
